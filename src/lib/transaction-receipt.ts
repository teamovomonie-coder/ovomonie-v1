import { receiptService } from './receipt-service';\n\nexport async function saveTransactionReceipt(\n  userId: string,\n  transactionId: string,\n  transactionReference: string,\n  transactionType: string,\n  transactionData: any\n) {\n  try {\n    let templateType: 'betting' | 'utility' | 'airtime' | 'internal-transfer' | 'external-transfer' | 'memo-transfer';\n    let receiptData: any;\n\n    // Determine template type and format data\n    switch (transactionType) {\n      case 'betting':\n        templateType = 'betting';\n        receiptData = {\n          platform: transactionData.platform || transactionData.bettingProvider || 'Betting Platform',\n          accountId: transactionData.accountId || transactionData.metadata?.accountId || 'N/A',\n          amount: transactionData.amount,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      case 'airtime':\n      case 'data':\n        templateType = 'airtime';\n        receiptData = {\n          network: transactionData.network || transactionData.party?.name || 'Mobile Network',\n          phoneNumber: transactionData.phoneNumber || transactionData.party?.billerId || transactionData.recipient || '',\n          planName: transactionData.planName || transactionData.party?.planName,\n          amount: transactionData.amount,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      case 'bill_payment':\n      case 'utility':\n        templateType = 'utility';\n        receiptData = {\n          biller: transactionData.biller || transactionData.party?.name || 'Service Provider',\n          accountId: transactionData.accountId || transactionData.party?.billerId || transactionData.customerId || '',\n          verifiedName: transactionData.verifiedName || transactionData.customerName,\n          token: transactionData.token,\n          KCT1: transactionData.KCT1,\n          KCT2: transactionData.KCT2,\n          amount: transactionData.amount,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      case 'internal_transfer':\n      case 'internal-transfer':\n        templateType = 'internal-transfer';\n        receiptData = {\n          recipientName: transactionData.recipientName || transactionData.metadata?.recipient_name || 'Recipient',\n          bankName: 'Ovomonie',\n          accountNumber: transactionData.accountNumber || transactionData.metadata?.recipient_account || '',\n          amount: transactionData.amount,\n          narration: transactionData.narration || transactionData.metadata?.narration,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      case 'external_transfer':\n      case 'external-transfer':\n        templateType = 'external-transfer';\n        receiptData = {\n          recipientName: transactionData.recipientName || transactionData.metadata?.recipient_name || 'Recipient',\n          bankName: transactionData.bankName || transactionData.metadata?.bank_name || 'Bank',\n          accountNumber: transactionData.accountNumber || transactionData.metadata?.recipient_account || '',\n          amount: transactionData.amount,\n          narration: transactionData.narration || transactionData.metadata?.narration,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      case 'memo_transfer':\n      case 'memo-transfer':\n        templateType = 'memo-transfer';\n        receiptData = {\n          recipientName: transactionData.recipientName || transactionData.metadata?.recipient_name || 'Recipient',\n          bankName: transactionData.bankName || transactionData.metadata?.bank_name || 'Bank',\n          accountNumber: transactionData.accountNumber || transactionData.metadata?.recipient_account || '',\n          amount: transactionData.amount,\n          message: transactionData.message || transactionData.metadata?.message,\n          transactionId: transactionReference,\n          completedAt: new Date().toISOString(),\n        };\n        break;\n\n      default:\n        console.warn('[TransactionReceipt] Unknown transaction type:', transactionType);\n        return null;\n    }\n\n    const receiptId = await receiptService.saveReceipt(\n      userId,\n      transactionId,\n      transactionReference,\n      templateType,\n      receiptData\n    );\n\n    console.log('[TransactionReceipt] Receipt saved:', receiptId);\n    return receiptId;\n  } catch (error) {\n    console.error('[TransactionReceipt] Error saving receipt:', error);\n    return null;\n  }\n}